{
    "name": "FlogoGW",
    "type": "flogo:app",
    "version": "0.0.1",
    "appModel": "1.0.0",
    "description": "IoT gateway for Raspberry pi",
    "triggers": [
        {
            "id": "timer_1",
            "ref": "github.com/TIBCOSoftware/flogo-contrib/trigger/timer",
            "name": "Timer (1)",
            "description": "Simple Timer trigger",
            "settings": {},
            "handlers": [
                {
                    "action": {
                        "ref": "github.com/TIBCOSoftware/flogo-contrib/action/flow",
                        "data": {
                            "flowURI": "res://flow:device_to_gw"
                        }
                    },
                    "settings": {
                        "repeating": "true",
                        "notImmediate": "false",
                        "startDate": null,
                        "hours": "",
                        "minutes": "",
                        "seconds": "2"
                    }
                }
            ]
        }
    ],
    "resources": [
        {
            "id": "flow:device_to_gw",
            "data": {
                "name": "Device to GW",
                "tasks": [
                    {
                        "id": "log_2",
                        "name": "Log MQTT",
                        "description": "Simple Log Activity",
                        "activity": {
                            "ref": "github.com/TIBCOSoftware/flogo-contrib/activity/log",
                            "input": {
                                "message": null,
                                "flowInfo": "true",
                                "addToFlow": "true"
                            }
                        }
                    },
                    {
                        "id": "gpio_3",
                        "name": "Set Direction GPIO",
                        "description": "Control raspberry gpio",
                        "activity": {
                            "ref": "github.com/TIBCOSoftware/flogo-contrib/activity/gpio",
                            "input": {
                                "method": "Direction",
                                "pinNumber": "23",
                                "direction": "Output",
                                "state": "",
                                "Pull": ""
                            }
                        }
                    },
                    {
                        "id": "gpio_4",
                        "name": "Read State GPIO&#160;",
                        "description": "Control raspberry gpio",
                        "activity": {
                            "ref": "github.com/TIBCOSoftware/flogo-contrib/activity/gpio",
                            "input": {
                                "method": "Read State",
                                "pinNumber": "23",
                                "direction": "",
                                "state": "",
                                "Pull": ""
                            }
                        }
                    },
                    {
                        "id": "log_5",
                        "name": "SetToOnLog",
                        "description": "Simple Log Activity",
                        "activity": {
                            "ref": "github.com/TIBCOSoftware/flogo-contrib/activity/log",
                            "input": {
                                "message": "Turning on the led",
                                "flowInfo": "true",
                                "addToFlow": "true"
                            }
                        }
                    },
                    {
                        "id": "gpio_7",
                        "name": "SetToOn GPIO",
                        "description": "Control raspberry gpio",
                        "activity": {
                            "ref": "github.com/TIBCOSoftware/flogo-contrib/activity/gpio",
                            "input": {
                                "method": "Set State",
                                "pinNumber": "23",
                                "direction": "",
                                "state": "High",
                                "Pull": ""
                            }
                        }
                    },
                    {
                        "id": "log_6",
                        "name": "SetToOffLog",
                        "description": "Simple Log Activity",
                        "activity": {
                            "ref": "github.com/TIBCOSoftware/flogo-contrib/activity/log",
                            "input": {
                                "message": "Turning off the led",
                                "flowInfo": "true",
                                "addToFlow": "true"
                            }
                        }
                    },
                    {
                        "id": "gpio_8",
                        "name": "Control GPIO",
                        "description": "Control raspberry gpio",
                        "activity": {
                            "ref": "github.com/TIBCOSoftware/flogo-contrib/activity/gpio",
                            "input": {
                                "method": "Set State",
                                "pinNumber": 0,
                                "direction": "",
                                "state": "Low",
                                "Pull": ""
                            }
                        }
                    }
                ],
                "links": [
                    {
                        "from": "log_2",
                        "to": "gpio_3"
                    },
                    {
                        "from": "gpio_3",
                        "to": "gpio_4"
                    },
                    {
                        "from": "gpio_4",
                        "to": "log_5",
                        "type": "expression",
                        "value": "true"
                    },
                    {
                        "from": "log_5",
                        "to": "gpio_7"
                    },
                    {
                        "from": "gpio_4",
                        "to": "log_6",
                        "type": "expression",
                        "value": "false"
                    },
                    {
                        "from": "log_6",
                        "to": "gpio_8"
                    }
                ],
                "errorHandler": {
                    "tasks": [
                        {
                            "id": "log_9",
                            "name": "Log Message",
                            "description": "Simple Log Activity",
                            "activity": {
                                "ref": "github.com/TIBCOSoftware/flogo-contrib/activity/log",
                                "input": {
                                    "message": "error",
                                    "flowInfo": "true",
                                    "addToFlow": "true"
                                }
                            }
                        }
                    ]
                }
            }
        }
    ]
}